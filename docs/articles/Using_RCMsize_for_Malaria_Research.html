<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using RCMsize for Malaria Research • RCMsize</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using RCMsize for Malaria Research">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RCMsize</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Using_RCMsize_for_Malaria_Research.html">Using RCMsize for Malaria Research</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/marciagraca/RCMsize/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using RCMsize for Malaria Research</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/marciagraca/RCMsize/blob/HEAD/vignettes/Using_RCMsize_for_Malaria_Research.Rmd" class="external-link"><code>vignettes/Using_RCMsize_for_Malaria_Research.Rmd</code></a></small>
      <div class="d-none name"><code>Using_RCMsize_for_Malaria_Research.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This package is designed primarily to calculate the sample size
required for studies where the main outcome measure is the
seroconversion rate (<code>SCR</code>). It provides tools to compute the
probability of an individual being seropositive, given specific
parameters such as the seroconversion rate (<code>SCR</code>) , the
seroreversion rate (<code>SRR</code>), and the individual’s age, using a
reversible catalytic model. Additionally, the package allows for the
calculation of seroprevalence (<code>SP</code>) and its corresponding
confidence interval. From the confidence interval of seroprevalence,
users can back-transform to obtain the confidence interval for the
seroconversion rate. Furthermore, the package allows for the calculation
of sample size while controlling for the relative length (width) of the
confidence interval for the seroconversion rate.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the RCMsize package from GitHub, use one of the following
commands:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"https://github.com/marciagraca/RCMsize"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"https://github.com/marciagraca/RCMsize"</span><span class="op">)</span></span></code></pre></div>
<p>After the installation is complete, you can load the RCMsize package
into your R session by running:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/marciagraca/RCMsize" class="external-link">RCMsize</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<div class="section level3">
<h3 id="prob_seropositive-calculation-of-seropositivity-probability">1. <strong><code>prob_seropositive</code></strong> – Calculation of
Seropositivity Probability<a class="anchor" aria-label="anchor" href="#prob_seropositive-calculation-of-seropositivity-probability"></a>
</h3>
<div class="section level4">
<h4 id="description">Description:<a class="anchor" aria-label="anchor" href="#description"></a>
</h4>
<p>This function calculates the probability of seropositivity for a
given age, based on the seroconversion rate (<code>SCR</code>) and the
seroreversion rate (<code>SRR</code>). It uses a reversible catalytic
model to calculate the probability that an individual will be
seropositive at a specific age.</p>
</div>
<div class="section level4">
<h4 id="parameters">Parameters:<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h4>
<ul>
<li>
<code>SCR</code>: The seroconversion rate.</li>
<li>
<code>SRR</code>: The seroreversion rate.</li>
<li>
<code>t</code>: The age of the individual.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example">Example:<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prob_seropositive.html">prob_seropositive</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.01</span>, <span class="fl">45</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.6260258</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="seroprevalence-seroprevalence-calculation">
<strong><code>seroprevalence</code></strong> – Seroprevalence
Calculation<a class="anchor" aria-label="anchor" href="#seroprevalence-seroprevalence-calculation"></a>
</h3>
<div class="section level4">
<h4 id="description-1">Description:<a class="anchor" aria-label="anchor" href="#description-1"></a>
</h4>
<p>This function calculates the seroprevalence (the proportion of
individuals who are seropositive) in a population, considering an age
distribution and using a reversible catalytic model. It aggregates the
probability of seropositivity across different ages to provide a total
estimate of seroprevalence for the population.</p>
</div>
<div class="section level4">
<h4 id="parameters-1">Parameters:<a class="anchor" aria-label="anchor" href="#parameters-1"></a>
</h4>
<ul>
<li>
<code>ages</code>: A vector representing the distribution of ages in
the population.</li>
<li>
<code>A_max</code>: The maximum age in the population.</li>
<li>
<code>SCR</code>: The seroconversion rate.</li>
<li>
<code>SRR</code>: The seroreversion rate.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-1">Example:<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seroprevalence.html">seroprevalence</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">80</span>, <span class="fl">80</span><span class="op">)</span>, <span class="fl">80</span>, <span class="fl">0.03</span>, <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.5296451</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="ic_sp-confidence-interval-for-seroprevalence">
<strong><code>IC_SP</code></strong> – Confidence Interval for
Seroprevalence<a class="anchor" aria-label="anchor" href="#ic_sp-confidence-interval-for-seroprevalence"></a>
</h3>
<div class="section level4">
<h4 id="description-2">Description:<a class="anchor" aria-label="anchor" href="#description-2"></a>
</h4>
<p>This function calculates the confidence interval for a seroprevalence
estimate using a specified confidence level. It employs binomial
confidence interval methods to compute the lower and upper bounds of the
interval based on the given seroprevalence estimate and sample size.
This function uses some of the methods available in the binom.confint
function of the binom package (see the references for a link to the
package).</p>
</div>
<div class="section level4">
<h4 id="parameters-2">Parameters:<a class="anchor" aria-label="anchor" href="#parameters-2"></a>
</h4>
<ul>
<li>
<code>SP</code>: The estimated seroprevalence value (proportion of
seropositive individuals).</li>
<li>
<code>n</code>: The sample size used for the estimation.</li>
<li>
<code>conf.level</code>: The desired confidence level (default is
0.95, representing 95% confidence).</li>
<li>
<code>method</code>: The method to calculate the confidence interval
(default is “asymptotic”). Available methods:
c(“asymptotic”,“exact”,“ac”,“wilson”,“logit”,“cloglog”)</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-2">Example:<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/IC_SP.html">IC_SP</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">100</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, method <span class="op">=</span> <span class="st">"asymptotic"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.1651311 0.3348689</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="ic_sp_waldcc-confidence-interval-for-seroprevalence-with-continuity-correction-wald-method">
<strong><code>IC_SP_Waldcc</code></strong> – Confidence Interval for
Seroprevalence with Continuity Correction (Wald Method)<a class="anchor" aria-label="anchor" href="#ic_sp_waldcc-confidence-interval-for-seroprevalence-with-continuity-correction-wald-method"></a>
</h3>
<div class="section level4">
<h4 id="description-3">Description:<a class="anchor" aria-label="anchor" href="#description-3"></a>
</h4>
<p>This function calculates the confidence interval for seroprevalence
using the Wald method with a continuity correction. The continuity
correction is applied by subtracting from the lower limit and adding to
the upper limit 1/(2n).</p>
</div>
<div class="section level4">
<h4 id="parameters-3">Parameters:<a class="anchor" aria-label="anchor" href="#parameters-3"></a>
</h4>
<ul>
<li>
<code>SP</code>: The estimated seroprevalence value (proportion of
seropositive individuals).</li>
<li>
<code>n</code>: The sample size used for the estimation.</li>
<li>
<code>conf.level</code>: The desired confidence level (default is
0.95, representing 95% confidence).</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-3">Example:<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/IC_SP_Waldcc.html">IC_SP_Waldcc</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">100</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.1601311 0.3398689</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="ic_scr-confidence-interval-for-the-seroconversion-rate-scr">
<strong><code>IC_SCR</code></strong> – Confidence Interval for the
Seroconversion Rate (<code>SCR</code>)<a class="anchor" aria-label="anchor" href="#ic_scr-confidence-interval-for-the-seroconversion-rate-scr"></a>
</h3>
<div class="section level4">
<h4 id="description-4">Description:<a class="anchor" aria-label="anchor" href="#description-4"></a>
</h4>
<p>This function calculates the confidence interval for the
seroconversion rate (<code>SCR</code>) using the confidence interval of
seroprevalence. The function uses numerical methods to solve for the SCR
that results in the observed seroprevalence.</p>
</div>
<div class="section level4">
<h4 id="parameters-4">Parameters:<a class="anchor" aria-label="anchor" href="#parameters-4"></a>
</h4>
<ul>
<li>
<code>SP_interval</code>: A vector containing the lower and upper
limits of the confidence interval for the seroprevalence.</li>
<li>
<code>SRR</code>: The seroreversion rate.</li>
<li>
<code>ages</code>: A vector with the distribution of ages in the
population.</li>
<li>
<code>A_max</code>: The maximum age in the population.</li>
<li>
<code>limits</code>: A vector specifying the lower and upper bounds
for the SCR (default is <code>c(0, 1)</code>).</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-4">Example:<a class="anchor" aria-label="anchor" href="#example-4"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/IC_SCR.html">IC_SCR</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="fl">0.01</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">80</span>, <span class="fl">80</span><span class="op">)</span>, <span class="fl">80</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.003433113 0.007502935</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="sample_s-sample-size-calculation">
<strong><code>sample_s</code></strong> – Sample Size
Calculation<a class="anchor" aria-label="anchor" href="#sample_s-sample-size-calculation"></a>
</h3>
<div class="section level4">
<h4 id="description-5">Description:<a class="anchor" aria-label="anchor" href="#description-5"></a>
</h4>
<p>This function estimates the required sample size so that the relative
width of the confidence interval for the seroconversion rate
(<code>SCR</code>) is equal to a specified value (<code>RL</code>). The
function calculates the necessary sample size by iteratively adjusting
the sample size until the confidence interval for SCR meets the desired
width criteria. This calculation is based on the seroprevalence,
confidence intervals for seroprevalence, and the seroconversion
rate.</p>
</div>
<div class="section level4">
<h4 id="parameters-5">Parameters:<a class="anchor" aria-label="anchor" href="#parameters-5"></a>
</h4>
<ul>
<li>
<code>SCR</code>: The seroconversion rate.</li>
<li>
<code>RL</code>: The desired relative width for the confidence
interval width for the seroconversion rate.</li>
<li>
<code>SRR</code>: The seroreversion rate.</li>
<li>
<code>ages</code>: A vector representing the distribution of ages in
the population.</li>
<li>
<code>A_max</code>: The maximum age in the population.</li>
<li>
<code>limits</code>: The lower and upper limits for the
<code>SCR</code>.</li>
<li>
<code>max_iter</code>: The maximum number of iterations for
adjusting the sample size (default is 10000).</li>
<li>
<code>conf.level</code>: The confidence level for the confidence
interval (default is 0.95).</li>
<li>
<code>method</code>: The method for calculating the confidence
interval for seroprevalence, default is <code>"asymptotic"</code>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-5">Example:<a class="anchor" aria-label="anchor" href="#example-5"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A_max</span> <span class="op">&lt;-</span> <span class="fl">80</span></span>
<span><span class="va">age_distribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">A_max</span>, <span class="va">A_max</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/sample_s.html">sample_s</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">1</span>, <span class="fl">0.01</span>, <span class="va">age_distribution</span>, <span class="va">A_max</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $n</span></span>
<span><span class="co">## [1] 57</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ci_sp</span></span>
<span><span class="co">## [1] 0.4000717 0.6592185</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ci_scr</span></span>
<span><span class="co">## [1] 0.0187055 0.0486105</span></span></code></pre>
<p><strong>Disclaimer</strong>: The sample size function may not produce
accurate values for scenarios involving extremely low SCR (e.g.,
elimination scenarios). Users are advised to exercise caution and
consider the results critically when applying this function to such
cases.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>For more information on reversible catalytic models, please refer to
the following <a href="https://link.springer.com/epdf/10.1186/s12936-015-0661-z?sharing_token=p35paPQECNk2SsN_VfKbBG_BpE1tBhCbnbw3BuzI2RN0kHnUjMYdn1CDr5te1vjhjSRq-RS05qBee7X_8VsbUuXhjK6F5obZwH425PlbFzIJqlQr2ySXYc-G80u9v9eqRp1YBPS_wwZnQIOXUZb9giwBIuM0SeGnxp6wjpdgfRY%3D" class="external-link">article</a>.</p>
<p>For details about the binom package, see the <a href="https://CRAN.R-project.org/package=binom" class="external-link">link</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Márcia Graça.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
